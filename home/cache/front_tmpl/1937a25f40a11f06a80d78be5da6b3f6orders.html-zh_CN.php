<?php if(!function_exists('tpl_function_link')){ require(CORE_DIR.'/include_v5/smartyplugins/function.link.php'); } if(!function_exists('tpl_modifier_cdate')){ require(CORE_DIR.'/include_v5/smartyplugins/modifier.cdate.php'); } if(!function_exists('tpl_function_pager')){ require(CORE_DIR.'/include_v5/smartyplugins/function.pager.php'); } $CURRENCY = &$this->system->loadModel('system/cur'); ?> <div class="MemberMain"> <div style="margin-right:175px;"> <div class="title">我的订单</div> <table class="memberlist blueth" width="100%" border="0" cellspacing="0" cellpadding="0"> <tr> <th>商品名称</th> <th>订单号</th> <th>下单日期</th> <th>总金额</th> <th>订单状态</th> </tr> <tbody> <?php $this->_env_vars['foreach'][orders]=array('total'=>count($this->_vars['orders']),'iteration'=>0);foreach ((array)$this->_vars['orders'] as $this->_vars['order']){ $this->_env_vars['foreach'][orders]['first'] = ($this->_env_vars['foreach'][orders]['iteration']==0); $this->_env_vars['foreach'][orders]['iteration']++; $this->_env_vars['foreach'][orders]['last'] = ($this->_env_vars['foreach'][orders]['iteration']==$this->_env_vars['foreach'][orders]['total']); ?> <tr> <td width="40%"><a href="<?php echo tpl_function_link(array('ctl' => member,'act' => orderdetail,'arg0' => $this->_vars['order']['order_id']), $this);?>"><?php echo $this->_vars['order']['tostr']; ?></a></td> <td><a href="<?php echo tpl_function_link(array('ctl' => member,'act' => orderdetail,'arg0' => $this->_vars['order']['order_id']), $this);?>"><?php echo $this->_vars['order']['order_id']; ?></a></td> <!--<td class="textwrap"><?php echo $this->_vars['order']['tostr']; ?></td> --> <td><?php echo tpl_modifier_cdate($this->_vars['order']['createtime'],FDATE_STIME); ?></td> <td><?php echo $CURRENCY->changer($this->_vars['order']['final_amount'],$this->_vars['order']['currency'],false,true); ?></td> <td><span class="point"> <?php if( $this->_vars['order']['status'] == 'finish' ){ ?>已完成 <?php }elseif( $this->_vars['order']['status'] == 'dead' ){ ?>已作废 <?php }else{  if( $this->_vars['order']['pay_status']==1 ){ ?>已付款 [<?php if( $this->_vars['order']['ship_status']==1 ){ ?> 已发货 <?php }elseif( $this->_vars['order']['ship_status']==2 ){ ?> 部分发货 <?php }elseif( $this->_vars['order']['ship_status']==3 ){ ?> 部分退货 <?php }elseif( $this->_vars['order']['ship_status']==4 ){ ?> 已退货 <?php }else{ ?> 正在备货... <?php } ?>] <?php }elseif( $this->_vars['order']['pay_status']==2 ){ ?> 已付款至担保方 <?php }elseif( $this->_vars['order']['pay_status']==3 ){ ?> <a href="<?php echo tpl_function_link(array('ctl' => member,'act' => orderpay,'arg0' => $this->_vars['order']['order_id']), $this);?>" >等待补款</a> <?php if( $this->_vars['order']['ship_status']==1 ){ ?> [已发货] <?php }elseif( $this->_vars['order']['ship_status']==2 ){ ?> [部分发货] <?php }elseif( $this->_vars['order']['ship_status']==3 ){ ?> [部分退货] <?php }elseif( $this->_vars['order']['ship_status']==4 ){ ?> [已退货] <?php }  }elseif( $this->_vars['order']['pay_status']==4 ){ ?> 部分退款 [<?php if( $this->_vars['order']['ship_status']==1 ){ ?> 已发货 <?php }elseif( $this->_vars['order']['ship_status']==2 ){ ?> 部分发货 <?php }elseif( $this->_vars['order']['ship_status']==4 ){ ?> 已退货 <?php }elseif( $this->_vars['order']['ship_status']==0 ){ ?> 未发货 <?php } ?>] <?php }elseif( $this->_vars['order']['pay_status']==5 ){ ?> 已退款 [<?php if( $this->_vars['order']['ship_status']==1 ){ ?> 已发货 <?php }elseif( $this->_vars['order']['ship_status']==2 ){ ?> 部分发货 <?php }elseif( $this->_vars['order']['ship_status']==4 ){ ?> 已退货 <?php }elseif( $this->_vars['order']['ship_status']==0 ){ ?> 未发货 <?php } ?>] <?php }else{ ?> <a href="<?php echo tpl_function_link(array('ctl' => member,'act' => orderpay,'arg0' => $this->_vars['order']['order_id']), $this);?>" >等待付款</a> <?php if( $this->_vars['order']['ship_status']==1 ){ ?> [已发货] <?php }elseif( $this->_vars['order']['ship_status']==2 ){ ?> [部分发货] <?php }elseif( $this->_vars['order']['ship_status']==3 ){ ?> [部分退货] <?php }elseif( $this->_vars['order']['ship_status']==4 ){ ?> [已退货] <?php }  }  } ?> </span></td> </tr> <?php } unset($this->_env_vars['foreach'][orders]); ?> </tbody> </table> <?php echo tpl_function_pager(array('data' => $this->_vars['pager']), $this);?> </div> </div> 