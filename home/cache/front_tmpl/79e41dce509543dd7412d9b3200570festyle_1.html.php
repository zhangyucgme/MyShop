<script>var <?php echo $this->_vars['var']; ?>;</script> <div id="mce_handle_<?php echo $this->_vars['var']; ?>" class="mce_style_1" style='opacity:0.4;FILTER:alpha(opacity=40);'> <ul> <li><img class="imgbundle x-align" src="images/transparent.gif" title="左对齐" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('justifyLeft')";?>" style="width:16px;height:16px;background-position:0 -1367px;" /></li> <li><img class="imgbundle x-align" src="images/transparent.gif" title="居中" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('justifyCenter')";?>" style="width:16px;height:16px;background-position:0 -1399px;" /></li> <li><img class="imgbundle x-align" src="images/transparent.gif" title="右对齐" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('justifyRight')";?>" style="width:16px;height:16px;background-position:0 -1415px;" /></li> <li><img src="images/transparent.gif" title="添加链接" onclick="<?php echo "{$this->_vars['var']}.mklink.bind({$this->_vars['var']})()";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1447px;" /></li> <li><img src="images/transparent.gif" title="插入表格" onclick="<?php echo "{$this->_vars['var']}.dialog.bind({$this->_vars['var']})('table',{title:'插入表格'})";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1527px;" /></li> <li><img src="images/transparent.gif" title="插入图片" onclick="<?php echo "{$this->_vars['var']}.dialog.bind({$this->_vars['var']})('image',{title:'插入图片'})";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1495px;" /></li> <li><img src="images/transparent.gif" title="插入横线" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('insertHTML','<hr />')";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1543px;" /></li> <li><img class="imgbundle x-enable" value="Bold" title="加粗" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('Bold')";?>" style="width:16px;height:16px;background-position:0 -1191px;" /></li> <li><img class="imgbundle x-enable" value="Italic" title="斜体" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('Italic')";?>" style="width:16px;height:16px;background-position:0 -1223px;" /></li> <li><img class="imgbundle x-enable" value="Underline" title="下划线" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('Underline')";?>" style="width:16px;height:16px;background-position:0 -1239px;" /></li> <li><img class="imgbundle x-enable" value="strikeThrough" title="中划线" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('strikeThrough')";?>" style="width:16px;height:16px;background-position:0 -1255px;" /></li> <li><img class="imgbundle x-enable" value="subscript" title="脚注" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('subscript')";?>" style="width:16px;height:16px;background-position:0 -1271px;" /></li> <li><img class="imgbundle x-enable" value="superscript" title="标注" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('superscript')";?>" style="width:16px;height:16px;background-position:0 -1287px;" /></li> <li><img class="imgbundle x-enable" value="insertOrderedList" title="排序列表" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('insertOrderedList')";?>" style="width:16px;height:16px;background-position:0 -1303px;" /></li> <li><img class="imgbundle x-enable" value="insertUnorderedList" title="无序列表" src="images/transparent.gif" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('insertUnorderedList')";?>" style="width:16px;height:16px;background-position:0 -1319px;" /></li> <li><img src="images/transparent.gif" title="减少缩进" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('outdent')";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1335px;" /></li> <li><img src="images/transparent.gif" title="增加缩进" onclick="<?php echo "{$this->_vars['var']}.set.bind({$this->_vars['var']})('indent')";?>" class="imgbundle" style="width:16px;height:16px;background-position:0 -1351px;" /></li> <li><select class='ft_select'> <option>字体</option> <option value='仿宋_GB2312'>仿宋</option> <option value='宋体'>宋体</option> <option value='黑体'>黑体</option> <option value='楷体_GB2312'>楷体</option> <option value='新宋体'>新宋体</option> <option value='Microsoft Yahei'>雅黑</option> <option value='Tahoma'>Tahoma</option> <option value='Times New Roman'>Times</option> <option value='Arial'>Arial</option> <option value='IMPACT'>IMPACT</option> <option value='Verdana'>Verdana</option> </select></li> <li><select class='fs_select'> <option>字号</option> <option value='1'>1</option> <option value='2'>2</option> <option value='3'>3</option> <option value='4'>4</option> <option value='5'>5</option> <option value='6'>6</option> <option value='7'>7</option> </select></li> <li><img class="imgbundle fontColorPicker" title="文字颜色" src="images/transparent.gif" style="width:16px;height:16px;background-position:0 -1639px;" /></li> <li><img class="imgbundle fontBGColorPicker" title="背景颜色" src="images/transparent.gif" style="width:16px;height:16px;background-position:0 -1655px;" /></li> <li onclick="<?php echo $this->_vars['var']; ?>.editHTML.call(<?php echo $this->_vars['var']; ?>)" style='color:#660000'>HTML源码</li> </ul> <br style='clear:both;display:none'/> </div> <div id='mce_handle_htmledit_<?php echo $this->_vars['var']; ?>' style='display:none' class='mce_style_1'> <span class='arrow-left'>&nbsp;</span> <span class='returnwyswyg' style='color:#000;cursor:pointer;'>返回可视化编辑</span> <span class='sysiconBtnNoIcon' title='粗体' htmltp='b'><strong>B</strong></span> <span class='sysiconBtnNoIcon' title='斜体' htmltp='i'><i>i</i></span> <span class='sysiconBtnNoIcon' title='下划线' htmltp='u'><u>U</u></span> <span class='sysiconBtnNoIcon' title='超链接' htmltp='link'>LINK</span> <span class='sysiconBtnNoIcon' title='DIV层' htmltp='div'>DIV</span> <span class='sysiconBtnNoIcon' title='段落' htmltp='p'>P</span> <span class='sysiconBtnNoIcon' title='LI' htmltp='li'>li</span> <span class='sysiconBtnNoIcon' title='BR' htmltp='br'>换行</span> <span class='sysiconBtnNoIcon' title='HR' htmltp='hr'>分割线</span> <span class='sysiconBtnNoIcon' title='图片' htmltp='img'>插入图片</span> </div> <script>
       
        mceHandler.implement(editor_style_1);
        <?php echo $this->_vars['var']; ?>=new mceHandler($('mce_handle_<?php echo $this->_vars['var']; ?>'),new mceInstance('<?php echo $this->_vars['for']; ?>',{includeBase:<?php echo $this->_vars['includeBase']; ?>}));
     
    
</script> <script>
void function(){
var textareaEditor_<?php echo $this->_vars['var']; ?>=new Abstract({
     element:$E('#mce_body_<?php echo $this->_vars['var']; ?> textarea'),
     getRange:function(){
       if(!!document.selection){
          return document.selection.createRange();
       }
       return false;
     },
     getSelection:function () {
		if(!!document.selection){
                 if(this.range){
                    return this.range.text;
                }
            return document.selection.createRange().text;
        }else if(!!this.element.setSelectionRange){
            return this.element.value.substring(this.element.selectionStart,this.element.selectionEnd);		
        }else{return false};
	 },replaceSelection:function (text) {
		var scrollTop=this.element.scrollTop;
        if(!!document.selection) {
			this.element.focus();			
           var old=document.selection.createRange().text;			
           var range=this.range||document.selection.createRange();			
           range.text=text;			
           range-=old.length-text.length;
		}else if(!!this.element.setSelectionRange) {
			var selection_start=this.element.selectionStart;			
            this.element.value=this.element.value.substring(0,selection_start)+text+this.element.value.substring(this.element.selectionEnd);			this.element.setSelectionRange(selection_start+text.length,selection_start+text.length);
		}
        this.element.focus();
		this.element.scrollTop=scrollTop;
	 },wrapSelection:function (before,after) {
		this.replaceSelection(before+this.getSelection()+after);
        this.range=null;
	 }
  });
  
 $E('#mce_body_<?php echo $this->_vars['var']; ?> textarea').addEvent('mouseup',function(){
     textareaEditor_<?php echo $this->_vars['var']; ?>.range=textareaEditor_<?php echo $this->_vars['var']; ?>.getRange();
 });
  
 $$('#mce_handle_htmledit_<?php echo $this->_vars['var']; ?> span[htmltp]').addEvent('click',function(e){
 
     var htmltp=this.get('htmltp');
     var B="";
     var A="";
     
     if(htmltp=='img'){
         
        return new Dialog('index.php?ctl=editor&act=image',{title:'插入<img>',onShow:function(){
           var dialog=this;
           this.dialog.store('callback',function(src,imgtag){
              textareaEditor_<?php echo $this->_vars['var']; ?>.wrapSelection(imgtag,A);
              dialog.close();
           });
        }});
         
     }
     
     
     switch (htmltp){
                 case 'b':
                     B="<b>";A="</b>";break;                     
                 case 'i':
                     B="<i>";A="</i>";break;  
                 case 'u':
                     B="<u>";A="</u>";break;         
                 case 'img':
                     B="<img src='#'/>";break;
                 case 'link':
                     B="<a href='#'>";A="</a>";break;      
                 case 'div':
                      B="<div>";A="</div>";break;      
                 case 'p':
                      B="<p>";A="</p>";break;      
                 case 'br':
                      B="<br/>";break;      
                 case 'hr':
                       B="<hr/>";break;
                 case 'li':
                       B="<li>";A="</li>";break;                         
     };
     textareaEditor_<?php echo $this->_vars['var']; ?>.wrapSelection(B,A);
 });
}();
    
</script>